<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô/‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏£‡∏≤‡∏¢‡∏õ‡∏µ (‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏•‡∏î‡∏î‡∏≠‡∏Å)</title>
  <!-- <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;max-width:1100px;margin:24px auto;color:#111}
    h1{font-size:20px;margin-bottom:6px}
    .card{padding:16px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.06);background:#fff;margin-bottom:12px}
    label{display:block;margin:6px 0 4px;font-weight:600}
    input,select{padding:8px;border:1px solid #ddd;border-radius:6px;width:100%;box-sizing:border-box}
    .row{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    button{padding:8px 12px;border-radius:8px;border:0;background:#1366d6;color:#fff;cursor:pointer}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{padding:8px;border:1px solid #eee;text-align:right}
    th{text-align:center;background:#f7f9fc}
    .muted{color:#666;font-size:13px}
    .small{font-size:13px}
    @media(max-width:700px){.row{grid-template-columns:1fr}}
  </style> -->
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      max-width: 1100px;
      margin: 24px auto;
      color: #222;
      background: linear-gradient(145deg, #f3f4f6, #e5e7eb);
    }
    h1 {
      font-size: 28px;
      margin-bottom: 12px;
      color: #1e40af;
      text-align: center;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.1);
    }
    .card {
      padding: 24px;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.1);
      background: #ffffffcc;
      backdrop-filter: blur(10px);
      margin-bottom: 20px;
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 30px rgba(0,0,0,0.15);
    }
    label {
      display: block;
      margin: 6px 0 4px;
      font-weight: 600;
      color: #1e3a8a;
    }
    input, select {
      padding: 10px;
      border: 1px solid #cbd5e1;
      border-radius: 12px;
      width: 100%;
      box-sizing: border-box;
      transition: border 0.3s, box-shadow 0.3s;
    }
    input:focus, select:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 6px rgba(59,130,246,0.4);
      outline: none;
    }
    .row {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 16px;
    }
    .controls {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 16px;
      align-items: center;
    }
    button {
      padding: 12px 20px;
      border-radius: 12px;
      border: 0;
      background: linear-gradient(90deg, #3b82f6, #1e3a8a);
      color: #fff;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.3s, transform 0.2s;
    }
    button:hover {
      background: linear-gradient(90deg, #2563eb, #1e40af);
      transform: translateY(-2px);
    }
    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin-top: 16px;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      background: #fff;
    }
    th, td {
      padding: 12px;
      text-align: right;
      border-bottom: 1px solid #e5e7eb;
    }
    th {
      text-align: center;
      background: linear-gradient(90deg, #e0e7ff, #c7d2fe);
      color: #1e3a8a;
      font-weight: 700;
    }
    tr:nth-child(even) td {
      background: #f9fafb;
    }
    .muted { color: #6b7280; font-size: 13px; }
    .small { font-size: 13px; }
    @media(max-width:700px){ .row{ grid-template-columns:1fr; } }
  </style>
</head>
<body>
  <h1>üìä ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ ‚Äî ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô/‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏£‡∏≤‡∏¢‡∏õ‡∏µ (‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏•‡∏î‡∏î‡∏≠‡∏Å)</h1>
  <div class="card">
    <div class="small muted">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ú‡πà‡∏≠‡∏ô‡πÅ‡∏ö‡∏ö‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏•‡∏î‡∏î‡∏≠‡∏Å (‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏Ñ‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠) ‚Äî ‡∏´‡∏≤‡∏Å‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏®‡∏ô‡∏¥‡∏¢‡∏°‡∏à‡∏∞ <strong>‡∏õ‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏≤‡∏ó</strong> ‡πÄ‡∏™‡∏°‡∏≠ ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>

    <div class="row" style="margin-top:12px">
      <div>
        <label>‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô (‡∏ö‡∏≤‡∏ó)</label>
        <input id="principal" type="number" min="0" step="1" value="100000" />
      </div>
      <div>
        <label>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ï‡πà‡∏≠‡∏õ‡∏µ (%)</label>
        <input id="annualRate" type="number" min="0" step="0.0001" value="7.75" />
      </div>
      <div>
        <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏õ‡∏µ</label>
        <input id="numYears" type="number" min="1" step="1" value="1" />
      </div>
    </div>

    <div class="row" style="margin-top:8px">
      <div>
        <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ï‡πà‡∏≠‡∏õ‡∏µ</label>
        <select id="daysPerYear">
          <option value="365">365 ‡∏ß‡∏±‡∏ô/‡∏õ‡∏µ (‡∏õ‡∏Å‡∏ï‡∏¥)</option>
          <option value="360">360 ‡∏ß‡∏±‡∏ô/‡∏õ‡∏µ (‡∏ö‡∏≤‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤)</option>
        </select>
      </div>
      <div>
        <label>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
        <input id="startDate" type="date" />
      </div>
      <div>
        <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ß‡∏î‡∏ú‡πà‡∏≠‡∏ô‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</label>
        <select id="payPerMonth">
          <option value="1">1 ‡∏á‡∏ß‡∏î/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
          <option value="2">2 ‡∏á‡∏ß‡∏î/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
        </select>
      </div>
    </div>

    <div class="controls">
      <button id="calcBtn">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
      <div class="muted small">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏ß‡∏î ‡πÅ‡∏ö‡∏ö‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏•‡∏î‡∏î‡∏≠‡∏Å ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</div>
    </div>
  </div>

  <div id="result" class="card" style="display:none">
    <h3>üìÜ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ú‡πà‡∏≠‡∏ô‡∏ä‡∏≥‡∏£‡∏∞ (‡∏•‡∏î‡∏ï‡πâ‡∏ô‡∏•‡∏î‡∏î‡∏≠‡∏Å)</h3>
    <div style="margin-top:8px;overflow:auto;max-height:500px">
      <table id="tablePayment">
        <thead>
          <tr>
            <th>‡∏á‡∏ß‡∏î</th>
            <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
            <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏Ñ‡∏¥‡∏î‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</th>
            <th>‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó)</th>
            <th>‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢ (‡∏ö‡∏≤‡∏ó)</th>
            <th>‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</th>
            <th>‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (‡∏ö‡∏≤‡∏ó)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <h3 style="margin-top:20px">üìÖ ‡∏™‡∏£‡∏∏‡∏õ‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</h3>
    <div style="margin-top:8px;overflow:auto;max-height:400px">
      <table id="tableMonthly">
        <thead>
          <tr>
            <th>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th>
            <th>‡∏õ‡∏µ</th>
            <th>‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <h3 style="margin-top:20px">üìÜ ‡∏™‡∏£‡∏∏‡∏õ‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏≤‡∏¢‡∏õ‡∏µ</h3>
    <div style="margin-top:8px;overflow:auto;max-height:400px">
      <table id="tableYearly">
        <thead>
          <tr>
            <th>‡∏õ‡∏µ</th>
            <th>‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <script>
    function formatMoney(n){
      return Number(n).toLocaleString('th-TH',{minimumFractionDigits:2,maximumFractionDigits:2});
    }

    function ceilToBaht(x){
      return Math.ceil(x);
    }

    (function setDefaultStart(){
      const today=new Date();
      const year=today.getFullYear();
      const dt=new Date(year,0,1);
      const iso=dt.toISOString().slice(0,10);
      document.getElementById('startDate').value=iso;
    })();

    document.getElementById('calcBtn').addEventListener('click',()=>{
      const principal=parseFloat(document.getElementById('principal').value)||0;
      const annual=parseFloat(document.getElementById('annualRate').value)||0;
      const years=parseInt(document.getElementById('numYears').value,10)||1;
      const daysPerYear=parseInt(document.getElementById('daysPerYear').value,10)||365;
      const startDateVal=document.getElementById('startDate').value;
      const payPerMonth=parseInt(document.getElementById('payPerMonth').value,10)||1;

      const totalMonths=years*12;
      const totalPayments=totalMonths*payPerMonth;
      let principalPerPayment=Math.ceil(principal/totalPayments);
      const dailyRate=(annual/100)/daysPerYear;

      let current=startDateVal?new Date(startDateVal+'T00:00:00'):new Date();
      if(isNaN(current)){current=new Date();}

      const tbody=document.querySelector('#tablePayment tbody');
      tbody.innerHTML='';

      const tbodyMonthly=document.querySelector('#tableMonthly tbody');
      tbodyMonthly.innerHTML='';

      const tbodyYearly=document.querySelector('#tableYearly tbody');
      tbodyYearly.innerHTML='';

      let balance=principal;
      let paymentNo=0;
      let monthlySummary={};
      let yearlySummary={};

      let lastPaymentDate=new Date(current); // ‡πÄ‡∏Å‡πá‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
      lastPaymentDate.setMonth(lastPaymentDate.getMonth()); // ‡∏á‡∏ß‡∏î‡πÅ‡∏£‡∏Å‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡∏¥‡∏î‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
      current.setMonth(current.getMonth()+1);

      for(let m=0;m<totalMonths;m++){
        for(let k=0;k<payPerMonth;k++){
          paymentNo++;

          // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡∏á‡∏ß‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏ñ‡∏∂‡∏á‡∏á‡∏ß‡∏î‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
          const days=Math.ceil((current - lastPaymentDate)/(1000*60*60*24));

          const interestRaw=balance*dailyRate*days;
          const interest=ceilToBaht(interestRaw);
          let principalPay=principalPerPayment;
          if(paymentNo===totalPayments){principalPay=balance;}

          const totalPay=principalPay+interest;
          balance-=principalPay;
          if(balance<0) balance=0;

          const row=document.createElement('tr');
          row.innerHTML=`
            <td style="text-align:center">${paymentNo}</td>
            <td>${current.toLocaleDateString('th-TH')}</td>
            <td style="text-align:center">${days}</td>
            <td>${formatMoney(principalPay)}</td>
            <td>${formatMoney(interest)}</td>
            <td>${formatMoney(totalPay)}</td>
            <td>${formatMoney(balance)}</td>
          `;
          tbody.appendChild(row);

          const month=current.getMonth()+1;
          const year=current.getFullYear();
          const key=year+'-'+month;
          if(!monthlySummary[key]) monthlySummary[key]=0;
          monthlySummary[key]+=interest;
          if(!yearlySummary[year]) yearlySummary[year]=0;
          yearlySummary[year]+=interest;

          lastPaymentDate=new Date(current); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡πà‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
          current.setMonth(current.getMonth()+1/payPerMonth);
        }
      }

      for(const key in monthlySummary){
        const [y,m]=key.split('-');
        const row=document.createElement('tr');
        row.innerHTML=`
          <td style="text-align:center">${m}</td>
          <td style="text-align:center">${y}</td>
          <td>${formatMoney(monthlySummary[key])}</td>
        `;
        tbodyMonthly.appendChild(row);
      }

      for(const y in yearlySummary){
        const row=document.createElement('tr');
        row.innerHTML=`
          <td style="text-align:center">${y}</td>
          <td>${formatMoney(yearlySummary[y])}</td>
        `;
        tbodyYearly.appendChild(row);
      }

      document.getElementById('result').style.display='block';
    });
  </script>
</body>
</html>
