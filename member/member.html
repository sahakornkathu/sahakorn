<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<!-- üîµ ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏ü‡πâ‡∏≤‡∏≠‡πà‡∏≠‡∏ô -->
<body class="bg-blue-50 p-6 text-slate-800">

<div class="max-w-7xl mx-auto space-y-6">

  <!-- Header -->
  <div class="bg-blue-100 border border-blue-200 rounded-xl p-6">
    <h1 class="text-2xl font-semibold">
      ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
    </h1>
    <p class="text-sm text-slate-600">
      ‡πÄ‡∏û‡∏¥‡πà‡∏° ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
    </p>
  </div>

  <!-- ================= FORM ================= -->
  <form id="memberForm" class="space-y-6">

    <!-- Section: Member -->
    <section class="bg-white border border-blue-200 rounded-xl p-6">
      <h2 class="section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h2>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div>
          <label class="label">‡∏£‡∏´‡∏±‡∏™‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</label>
          <input id="member_id" type="number" class="input" required>
        </div>
        <div>
          <label class="label">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏±‡∏Ñ‡∏£</label>
          <input id="join_date" type="date" class="input">
        </div>
        <div>
          <label class="label">‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤</label>
          <input id="title" class="input">
        </div>
        <div>
          <label class="label">‡∏Å‡∏•‡∏∏‡πà‡∏°</label>
          <input id="group" class="input">
        </div>

        <div>
          <label class="label">‡∏ä‡∏∑‡πà‡∏≠</label>
          <input id="first_name" class="input" required>
        </div>
        <div>
          <label class="label">‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
          <input id="last_name" class="input" required>
        </div>
        <div>
          <label class="label">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</label>
          <input id="id_card" class="input">
        </div>
        <div>
          <label class="label">‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</label>
          <input id="birthday" type="date" class="input">
        </div>
      </div>
    </section>

    <!-- Section: Address -->
    <section class="bg-white border border-blue-200 rounded-xl p-6">
      <h2 class="section-title">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</h2>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
        <div>
          <label class="label">‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà</label>
          <input id="house_no" class="input">
        </div>
        <div>
          <label class="label">‡∏´‡∏°‡∏π‡πà</label>
          <input id="moo" class="input">
        </div>
        <div>
          <label class="label">‡∏ñ‡∏ô‡∏ô</label>
          <input id="street" class="input">
        </div>
        <div>
          <label class="label">‡∏´‡∏°‡∏π‡πà‡∏ö‡πâ‡∏≤‡∏ô</label>
          <input id="village" class="input">
        </div>

        <div>
          <label class="label">‡∏ï‡∏≥‡∏ö‡∏•</label>
          <input id="subdistrict" class="input">
        </div>
        <div>
          <label class="label">‡∏≠‡∏≥‡πÄ‡∏†‡∏≠</label>
          <input id="district" class="input">
        </div>
        <div>
          <label class="label">‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
          <input id="province" class="input">
        </div>
        <div>
          <label class="label">‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏õ‡∏£‡∏©‡∏ì‡∏µ‡∏¢‡πå</label>
          <input id="postal_code" class="input">
        </div>
      </div>
    </section>

    <!-- Section: Contact -->
    <section class="bg-white border border-blue-200 rounded-xl p-6">
      <h2 class="section-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</h2>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="label">‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
          <input id="phone" class="input">
        </div>
        <div>
          <label class="label">‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏™‡∏≥‡∏£‡∏≠‡∏á</label>
          <input id="phone_alt" class="input">
        </div>
      </div>
    </section>

    <!-- Section: Status -->
    <section class="bg-white border border-blue-200 rounded-xl p-6">
      <h2 class="section-title">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</h2>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div>
          <label class="label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</label>
          <select id="member_status" class="input">
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
            <option value="active">‡∏õ‡∏Å‡∏ï‡∏¥</option>
            <option value="inactive">‡∏û‡πâ‡∏ô‡∏™‡∏†‡∏≤‡∏û</option>
          </select>
        </div>

        <div>
          <label class="label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏†‡∏≤‡∏û‡∏™‡∏°‡∏£‡∏™</label>
          <select id="marital_status" class="input">
            <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
            <option value="single">‡πÇ‡∏™‡∏î</option>
            <option value="married">‡∏™‡∏°‡∏£‡∏™</option>
          </select>
        </div>

        <div>
          <label class="label">‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏π‡πà‡∏™‡∏°‡∏£‡∏™</label>
          <input id="spouse_name" class="input">
        </div>
      </div>
    </section>

    <!-- Actions -->
    <div class="flex gap-4">
      <button type="submit" class="btn-primary">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
      <button type="button" onclick="resetForm()" class="btn-secondary">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
    </div>

  </form>

  <!-- ================= TABLE ================= -->
  <div class="bg-white border border-blue-300 rounded-xl p-6">
    <h2 class="section-title mb-4">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h2>

    <table class="w-full text-sm">
      <thead class="bg-blue-100">
        <tr>
          <th class="th">‡∏£‡∏´‡∏±‡∏™</th>
          <th class="th">‡∏ä‡∏∑‡πà‡∏≠-‡∏™‡∏Å‡∏∏‡∏•</th>
          <th class="th">‡πÇ‡∏ó‡∏£</th>
          <th class="th">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
          <th class="th text-center">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
        </tr>
      </thead>
      <tbody id="rows" class="divide-y"></tbody>
    </table>
  </div>

</div>

<!-- ================= SCRIPT (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) ================= -->
<script type="module">
import { createClient } from 'https://esm.sh/@supabase/supabase-js@2'

const db = createClient(
  'https://ttottijljxoinptmhgtu.supabase.co',
  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR0b3R0aWpsanhvaW5wdG1oZ3R1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgwMTYxODQsImV4cCI6MjA3MzU5MjE4NH0.XnIf3xLzSbZDwFVKWjLTCiF4jnnDMQ1W95EI-v6F-3Y'
)

const form = document.getElementById('memberForm')
const rows = document.getElementById('rows')

async function loadMembers() {
  const { data } = await db.from('members').select('*').order('member_id')
  rows.innerHTML = ''
  data.forEach(m => {
    rows.innerHTML += `
      <tr class="hover:bg-blue-50">
        <td class="td">${m.member_id}</td>
        <td class="td">${m.first_name} ${m.last_name}</td>
        <td class="td">${m.phone ?? ''}</td>
        <td class="td">${m.member_status ?? ''}</td>
        <td class="td text-center">
          <button onclick='editMember(${JSON.stringify(m)})'
            class="text-blue-700 hover:underline">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
          <button onclick="deleteMember(${m.member_id})"
            class="text-red-600 hover:underline ml-3">‡∏•‡∏ö</button>
        </td>
      </tr>`
  })
}

form.addEventListener('submit', async e => {
  e.preventDefault()
  const data = Object.fromEntries(
    [...form.elements].filter(el => el.id).map(el => [el.id, el.value || null])
  )
  await db.from('members').upsert([data], { onConflict: 'member_id' })
  resetForm()
  loadMembers()
})

window.editMember = m => {
  member_id.value = m.member_id
  member_id.disabled = true
  for (const k in m)
    if (document.getElementById(k))
      document.getElementById(k).value = m[k] ?? ''
}

window.deleteMember = async id => {
  if (!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ?')) return
  await db.from('members').delete().eq('member_id', id)
  loadMembers()
}

window.resetForm = () => {
  form.reset()
  member_id.disabled = false
}

loadMembers()
</script>

<style>
.section-title { @apply text-lg font-semibold mb-4 }
.label { @apply text-sm text-slate-700 mb-1 block }
.input {
  @apply w-full border border-slate-300 rounded-lg px-3 py-2
         focus:outline-none focus:ring-2 focus:ring-blue-400
}
.th { @apply px-3 py-2 text-left font-semibold }
.td { @apply px-3 py-2 }
.btn-primary {
  @apply bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg
}
.btn-secondary {
  @apply bg-slate-300 hover:bg-slate-400 text-slate-800 px-6 py-2 rounded-lg
}
</style>

</body>
</html>
