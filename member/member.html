<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap');
body { font-family:"Prompt",sans-serif; background:#f0f4f8; margin:20px; color:#333; }
h2 { text-align:center; color:#1e40af; margin-bottom:15px; }
#filterDiv {
  background:#fff; padding:12px 15px; border-radius:10px;
  max-width:950px; margin:25px auto; box-shadow:0 4px 12px rgba(0,0,0,0.08);
  display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:center;
}
#filterDiv select, #filterDiv input {
  padding:6px 8px; border:1px solid #ccc; border-radius:6px;
  font-size:13px; background:#f9fafb;
}
#filterDiv button {
  padding:6px 14px; background:#38a169; color:#fff; border:none;
  border-radius:6px; cursor:pointer; font-size:13px;
}
#filterDiv button:hover { background:#2f855a; }
table { border-collapse:collapse; width:100%; max-width:1000px; margin:auto; font-size:13px; background:#fff;
  border-radius:10px; overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,0.08);
}
th, td { border:1px solid #e2e8f0; padding:6px 8px; text-align:center; }
th { background:#4a90e2; color:#fff; font-weight:500; }
tr:nth-child(even){ background:#f9fafb; }
tr:hover{ background:#edf2f7; }
</style>
</head>
<body>

<h2>‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</h2>

<!-- üîπ ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏£‡∏≠‡∏á -->
<div id="filterDiv">
  <select id="searchGroup">
    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏∏‡πà‡∏° --</option>
    <option value="1">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà 1</option>
    <option value="2">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà 2</option>
    <option value="3">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà 3</option>
    <option value="4">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà 4</option>
    <option value="5">‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà 5</option>
  </select>

  <select id="searchStatus">
    <option value="">-- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å --</option>
    <option value="‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</option>
    <option value="‡∏•‡∏≤‡∏≠‡∏≠‡∏Å">‡∏•‡∏≤‡∏≠‡∏≠‡∏Å</option>
    <option value="‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï">‡πÄ‡∏™‡∏µ‡∏¢‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï</option>
  </select>

  <select id="searchGender">
    <option value="">-- ‡πÄ‡∏û‡∏® --</option>
    <option value="‡∏ä‡∏≤‡∏¢">‡∏ä‡∏≤‡∏¢</option>
    <option value="‡∏´‡∏ç‡∏¥‡∏á">‡∏´‡∏ç‡∏¥‡∏á</option>
    <option value="‡∏≠‡∏∑‡πà‡∏ô‡πÜ">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
  </select>

  <input type="date" id="searchStartDate" placeholder="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô">
  <input type="date" id="searchEndDate" placeholder="‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î">

  <button id="printReport">üñ®Ô∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
</div>

<!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á (‡∏à‡∏∞‡∏°‡∏µ JS ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏à‡∏£‡∏¥‡∏á) -->
<table id="memberTable">
  <thead>
    <tr>
      <th>‡πÄ‡∏•‡∏Ç‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</th>
      <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
      <th>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</th>
      <th>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</th>
      <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
// -------------------------------
// ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏à‡∏≥‡∏•‡∏≠‡∏á
// -------------------------------
const allMembers = [
  {
    member_id: "001",
    title: "‡∏ô‡∏≤‡∏¢", first_name: "‡∏™‡∏°‡∏ä‡∏≤‡∏¢", last_name: "‡πÉ‡∏à‡∏î‡∏µ",
    house_no: "12", moo: "3", street: "‡∏™‡∏∏‡∏Ç‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡πå", village: "‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏ß‡∏ô",
    subdistrict: "‡∏ö‡∏≤‡∏á‡∏£‡∏±‡∏Å", district: "‡πÄ‡∏°‡∏∑‡∏≠‡∏á", province: "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø", postal_code: "10100",
    phone: "0812345678", join_date: "2024-05-10",
    member_status: "‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å", gender: "‡∏ä‡∏≤‡∏¢", group: "1"
  },
  {
    member_id: "002",
    title: "‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß", first_name: "‡∏°‡∏≤‡∏•‡∏µ", last_name: "‡∏û‡∏£‡∏î‡∏µ",
    house_no: "45/2", moo: "1", street: "‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏≠‡∏∏‡∏ó‡∏¥‡∏®", village: "‡∏û‡∏§‡∏Å‡∏©‡∏≤",
    subdistrict: "‡∏ö‡∏≤‡∏á‡πÄ‡∏Ç‡∏ô", district: "‡πÄ‡∏°‡∏∑‡∏≠‡∏á", province: "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ", postal_code: "11000",
    phone: "0898765432", join_date: "2024-07-22",
    member_status: "‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å", gender: "‡∏´‡∏ç‡∏¥‡∏á", group: "2"
  },
  {
    member_id: "003",
    title: "‡∏ô‡∏≤‡∏¢", first_name: "‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥", last_name: "‡∏™‡∏∏‡∏Ç‡πÉ‡∏à",
    house_no: "88", moo: "5", street: "‡πÄ‡∏û‡∏ä‡∏£‡πÄ‡∏Å‡∏©‡∏°", village: "‡∏ö‡πâ‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà",
    subdistrict: "‡∏ö‡∏≤‡∏á‡πÉ‡∏´‡∏ç‡πà", district: "‡∏ö‡∏≤‡∏á‡πÉ‡∏´‡∏ç‡πà", province: "‡∏ô‡∏ô‡∏ó‡∏ö‡∏∏‡∏£‡∏µ", postal_code: "11140",
    phone: "0822222222", join_date: "2023-12-15",
    member_status: "‡∏•‡∏≤‡∏≠‡∏≠‡∏Å", gender: "‡∏ä‡∏≤‡∏¢", group: "1"
  }
];

// -------------------------------
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
// -------------------------------
function renderTable(members){
  const tbody = document.querySelector("#memberTable tbody");
  tbody.innerHTML = "";
  members.forEach(m=>{
    const fullName = `${m.title||''} ${m.first_name||''} ${m.last_name||''}`;
    const fullAddress = `${m.house_no||''} ${m.moo||''} ${m.street||''} ${m.village||''} ${m.subdistrict||''} ${m.district||''} ${m.province||''} ${m.postal_code||''}`.replace(/\s+/g,' ').trim();
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${m.member_id}</td>
      <td>${fullName}</td>
      <td>${fullAddress}</td>
      <td>${m.phone || ""}</td>
      <td>${m.join_date || ""}</td>
    `;
    tbody.appendChild(tr);
  });
}
renderTable(allMembers);

// -------------------------------
// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏£‡∏¥‡πâ‡∏ô‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
// -------------------------------
document.getElementById('printReport').addEventListener('click', () => {
  const groupFilter = document.getElementById('searchGroup').value.toLowerCase();
  const statusFilter = document.getElementById('searchStatus').value;
  const genderFilter = document.getElementById('searchGender').value;
  const startDate = document.getElementById('searchStartDate').value;
  const endDate = document.getElementById('searchEndDate').value;

  const filtered = allMembers.filter(m => {
    const joinDate = m.join_date ? new Date(m.join_date) : null;
    const start = startDate ? new Date(startDate) : null;
    const end = endDate ? new Date(endDate) : null;

    const dateMatch =
      (!start && !end) ||
      (joinDate &&
        (!start || joinDate >= start) &&
        (!end || joinDate <= end));

    return (!groupFilter || (m.group && m.group.toLowerCase() === groupFilter)) &&
           (!statusFilter || m.member_status === statusFilter) &&
           (!genderFilter || m.gender === genderFilter) &&
           dateMatch;
  });

  const groupLabel = groupFilter ? `‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ó‡∏µ‡πà ${groupFilter}` : '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î';
  const dateLabel = (startDate || endDate)
    ? `‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${startDate || '-'} ‡∏ñ‡∏∂‡∏á ${endDate || '-'}`
    : '‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤';

  let printContent = `
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
      <div style="flex:0 0 auto;">
        <img src="https://lh5.googleusercontent.com/d/1B0sZdUz54kO4zAv0oJgoN4Aipy3UyCyR=w100-h100" 
             alt="Logo" style="max-width:100px;height:auto;">
      </div>
      <div style="flex:1;text-align:center;">
        <h2 style="margin:0;">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô${groupLabel}</h2>
        <div style="font-size:14px;">
          ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å: ${statusFilter || '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î'} |
          ‡πÄ‡∏û‡∏®: ${genderFilter || '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î'} |
          ${dateLabel}
        </div>
      </div>
      <div style="flex:0 0 100px;"></div>
    </div>
    <table border="1" cellspacing="0" cellpadding="5"
      style="width:100%; border-collapse:collapse; font-family:'Prompt',sans-serif; font-size:13px;">
      <tr style="background-color:#4a90e2; color:white;">
        <th>‡πÄ‡∏•‡∏Ç‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</th>
        <th>‡∏Ñ‡∏≥‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤ ‡∏ä‡∏∑‡πà‡∏≠ ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
        <th>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</th>
        <th>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</th>
        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</th>
      </tr>
  `;

  filtered.forEach(m => {
    const fullName = `${m.title||''} ${m.first_name||''} ${m.last_name||''}`.trim();
    const fullAddress = `${m.house_no||''} ${m.moo||''} ${m.street||''} ${m.village||''} ${m.subdistrict||''} ${m.district||''} ${m.province||''} ${m.postal_code||''}`.replace(/\s+/g,' ').trim();
    const phone = m.phone || '';
    printContent += `
      <tr>
        <td>${m.member_id}</td>
        <td>${fullName}</td>
        <td>${fullAddress}</td>
        <td>${phone}</td>
        <td>${m.join_date || ''}</td>
      </tr>`;
  });

  printContent += '</table>';

  const w = window.open('', '', 'width=900,height=600');
  w.document.write('<html><head><title>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</title>');
  w.document.write('<style>body{font-family:"Prompt",sans-serif; margin:20px;} h2{text-align:center;}</style></head><body>');
  w.document.write(printContent);
  w.document.write('</body></html>');
  w.document.close();
  w.print();
});
</script>

</body>
</html>
