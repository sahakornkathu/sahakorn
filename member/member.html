<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>ระบบจัดการข้อมูลสมาชิก</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-blue-50 p-6 text-slate-800">

<div class="max-w-7xl mx-auto space-y-6">

  <!-- Header -->
  <div class="bg-blue-100 border-2 border-blue-300 rounded-xl p-6">
    <h1 class="text-2xl font-semibold">ระบบจัดการข้อมูลสมาชิก</h1>
    <p class="text-sm text-slate-600">ฟอร์มบันทึกข้อมูลสมาชิก</p>
  </div>

  <!-- ================= FORM ================= -->
  <form id="memberForm" class="space-y-6">

    <!-- ข้อมูลสมาชิก -->
    <div class="section">
      <h2 class="section-title">ข้อมูลสมาชิก</h2>

      <div class="grid grid-cols-1 md:grid-cols-4 gap-4">

        <div class="h-field">
          <label>รหัสสมาชิก</label>
          <input id="member_id" type="number" required>
        </div>

        <div class="h-field">
          <label>วันที่สมัคร</label>
          <input id="join_date" type="date">
        </div>

        <!-- ⭐ คำนำหน้า (dropdown) -->
        <div class="h-field">
          <label>คำนำหน้า</label>
          <select id="title">
            <option value="">-- เลือก --</option>
            <option value="นาย">นาย</option>
            <option value="นาง">นาง</option>
            <option value="นางสาว">นางสาว</option>
            <option value="ด.ช.">ด.ช.</option>
            <option value="ด.ญ.">ด.ญ.</option>
          </select>
        </div>

        <div class="h-field">
          <label>กลุ่ม</label>
          <input id="group">
        </div>

        <div class="h-field">
          <label>ชื่อ</label>
          <input id="first_name" required>
        </div>

        <div class="h-field">
          <label>นามสกุล</label>
          <input id="last_name" required>
        </div>

        <div class="h-field">
          <label>เลขบัตรประชาชน</label>
          <input id="id_card">
        </div>

        <div class="h-field">
          <label>วันเกิด</label>
          <input id="birthday" type="date">
        </div>

      </div>
    </div>

    <!-- ข้อมูลติดต่อ -->
    <div class="section">
      <h2 class="section-title">ข้อมูลติดต่อ</h2>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="h-field">
          <label>โทรศัพท์</label>
          <input id="phone">
        </div>
        <div class="h-field">
          <label>โทรศัพท์สำรอง</label>
          <input id="phone_alt">
        </div>
      </div>
    </div>

    <!-- สถานะ -->
    <div class="section">
      <h2 class="section-title">สถานะ</h2>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="h-field">
          <label>สถานะสมาชิก</label>
          <select id="member_status">
            <option value="">-- เลือก --</option>
            <option value="active">ปกติ</option>
            <option value="inactive">พ้นสภาพ</option>
          </select>
        </div>

        <div class="h-field">
          <label>สถานภาพสมรส</label>
          <select id="marital_status">
            <option value="">-- เลือก --</option>
            <option value="single">โสด</option>
            <option value="married">สมรส</option>
          </select>
        </div>

        <div class="h-field">
          <label>ชื่อคู่สมรส</label>
          <input id="spouse_name">
        </div>
      </div>
    </div>

    <!-- Actions -->
    <div class="flex gap-4">
      <button type="submit" class="btn-primary">บันทึกข้อมูล</button>
      <button type="button" onclick="resetForm()" class="btn-secondary">ยกเลิก</button>
    </div>

  </form>

</div>

<!-- ================= SCRIPT (เหมือนเดิม) ================= -->
<script type="module">
import { createClient } from 'https://esm.sh/@supabase/supabase-js@2'

const db = createClient(
  'https://ttottijljxoinptmhgtu.supabase.co',
  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR0b3R0aWpsanhvaW5wdG1oZ3R1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgwMTYxODQsImV4cCI6MjA3MzU5MjE4NH0.XnIf3xLzSbZDwFVKWjLTCiF4jnnDMQ1W95EI-v6F-3Y'
)

const form = document.getElementById('memberForm')

form.addEventListener('submit', async e => {
  e.preventDefault()
  const data = Object.fromEntries(
    [...form.elements].filter(el => el.id).map(el => [el.id, el.value || null])
  )
  await db.from('members').upsert([data], { onConflict: 'member_id' })
  form.reset()
})
</script>

<style>
.section {
  @apply bg-white border-2 border-blue-300 rounded-xl p-6;
}
.section-title {
  @apply text-lg font-semibold mb-4;
}

/* ฟอร์มแนวนอน */
.h-field {
  @apply flex items-center gap-3;
}
.h-field label {
  @apply w-32 text-sm font-medium text-slate-700 whitespace-nowrap;
}
.h-field input,
.h-field select {
  @apply flex-1 bg-slate-50 border-2 border-slate-400 rounded-md
         px-3 py-2
         focus:outline-none focus:border-blue-600
         focus:ring-2 focus:ring-blue-200;
}

.btn-primary {
  @apply bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg;
}
.btn-secondary {
  @apply bg-slate-300 hover:bg-slate-400 text-slate-800 px-6 py-2 rounded-lg;
}
</style>

</body>
</html>
