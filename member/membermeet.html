<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>à¸—à¸”à¸ªà¸­à¸šà¸”à¸¶à¸‡à¸ªà¸¡à¸²à¸Šà¸´à¸</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://esm.sh/@supabase/supabase-js@2"></script>
</head>

<body class="bg-slate-900 text-white p-6">

<div class="max-w-xl mx-auto space-y-4">
  <h1 class="text-xl font-bold">à¸„à¹‰à¸™à¸«à¸²à¸ªà¸¡à¸²à¸Šà¸´à¸</h1>

  <input id="member_id" type="number"
    class="w-full p-2 rounded text-black"
    placeholder="à¹ƒà¸ªà¹ˆà¸£à¸«à¸±à¸ªà¸ªà¸¡à¸²à¸Šà¸´à¸">

  <input id="title" class="w-full p-2 rounded text-black" placeholder="à¸„à¸³à¸™à¸³à¸«à¸™à¹‰à¸²" readonly>
  <input id="first_name" class="w-full p-2 rounded text-black" placeholder="à¸Šà¸·à¹ˆà¸­" readonly>
  <input id="last_name" class="w-full p-2 rounded text-black" placeholder="à¸™à¸²à¸¡à¸ªà¸à¸¸à¸¥" readonly>
  <input id="group" class="w-full p-2 rounded text-black" placeholder="à¸à¸¥à¸¸à¹ˆà¸¡" readonly>
</div>

<script type="module">
import { createClient } from 'https://esm.sh/@supabase/supabase-js@2'

const SUPABASE_URL = 'https://ttottijljxoinptmhgtu.supabase.co'
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR0b3R0aWpsanhvaW5wdG1oZ3R1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgwMTYxODQsImV4cCI6MjA3MzU5MjE4NH0.XnIf3xLzSbZDwFVKWjLTCiF4jnnDMQ1W95EI-v6F-3Y'
const db = createClient(SUPABASE_URL, SUPABASE_KEY)

const memberIdInput = document.getElementById('member_id')
const titleInput = document.getElementById('title')
const firstNameInput = document.getElementById('first_name')
const lastNameInput = document.getElementById('last_name')
const groupInput = document.getElementById('group')

memberIdInput.addEventListener('blur', async () => {
  const raw = memberIdInput.value.trim()

  if (!raw) return

  // ğŸ”§ à¸ˆà¸¸à¸”à¸ªà¸³à¸„à¸±à¸ â€” à¸«à¹‰à¸²à¸¡à¸¡à¸µ ":" à¹à¸¥à¸°à¹à¸›à¸¥à¸‡à¹€à¸›à¹‡à¸™à¸•à¸±à¸§à¹€à¸¥à¸‚
  const id = Number(raw)

  if (isNaN(id)) {
    alert('à¸£à¸«à¸±à¸ªà¸ªà¸¡à¸²à¸Šà¸´à¸à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡')
    return
  }

  const { data, error } = await db
    .from('members')
    .select('title, first_name, last_name, "group"')
    .eq('member_id', id)
    .maybeSingle()

  if (error || !data) {
    alert('à¹„à¸¡à¹ˆà¸à¸šà¸ªà¸¡à¸²à¸Šà¸´à¸')
    titleInput.value = ''
    firstNameInput.value = ''
    lastNameInput.value = ''
    groupInput.value = ''
    return
  }

  titleInput.value = data.title || ''
  firstNameInput.value = data.first_name || ''
  lastNameInput.value = data.last_name || ''
  groupInput.value = data.group || ''
})
</script>

</body>
</html>
