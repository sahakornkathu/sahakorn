<script>
function exportExcel(){
  const rows = [];
  const items = document.querySelectorAll("#membersList li");

  if(items.length === 0){
    alert("ไม่มีข้อมูลให้ export");
    return;
  }

  items.forEach(li => {
    const text = li.querySelector("div").innerText;
    // รูปแบบ: ชื่อ นามสกุล | โทร | เพศ | จังหวัด | สถานะ
    const parts = text.split("|").map(t => t.trim());

    rows.push({
      name: parts[0] || "",
      phone: parts[1] || "",
      gender: parts[2] || "",
      province: parts[3] || "",
      status: parts[4] || ""
    });
  });

  const header = Object.keys(rows[0]).join(",");
  const body = rows.map(r => Object.values(r).join(",")).join("\n");
  const csv = header + "\n" + body;

  const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "members_from_list.csv";
  a.click();
}
</script>
